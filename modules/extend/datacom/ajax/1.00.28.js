"use strict";define(["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var e={ajax:function(){for(var a=justory.configs,e=justory.msgini,t=arguments.length,o=Array(t),r=0;t>r;r++)o[r]=arguments[r];var s="function"==typeof o.last()?o.last():"",n=this.type||"get",u=this.upload||!1,i=o[0],d=o[1]||{},l=d||{},f={},m=!1,p=a.baseUrl,c={},j={};a.ajaxComBeforeSend(l,function(t){var o=t.params,r=t.headers;if(o&&o.length>0)for(var g=0;g<o.length;g++){var h=o[g].key,y=o[g].value;l[h]=y,o[g].alwaysGet&&[j[h]=y]}if(r&&r.length>0)for(var g=0;g<r.length;g++){var h=r[g].key,y=r[g].value;f[h]=y}"post"==n&&(i=i.indexOf("?")>-1?i+"&"+$.param(j):i+"?"+$.param(j),c={values:l},u&&[c.files=d]),("get"==n||"jsonp"==n)&&(i=i.indexOf("?")>-1?i+"&"+$.param(l):i+"?"+$.param(l)),i.indexOf("http")>-1&&(p=""),justory.log("ajax send",{method:n,data:c,url:p+i});var v=function(t,o){justory.log("ajax result",{ret:t});var r=t.headers,n=t.body;if(n)a.ajaxComAfterSend(n,function(){s&&s(n,r)});else{var u="错误码："+o.code+"；错误信息："+o.msg+"；网络状态码："+o.statusCode,i=o.code;(""===i||void 0==i)&&(i="unknown"),justory.log("ajax message",{msg:u}),api.toast({msg:e.ajax[i]}),"root"!=api.winName&&setTimeout(function(){api.closeWin()},3e3)}};"jsonp"==n?$.ajax({type:"GET",data:c,url:p+i,timeout:a.ajaxTimeout,dataType:"jsonp",headers:f||{},success:function(a){v({headers:{},body:a},{code:1})}}):api.ajax({method:n,tag:tag||"",cache:m,data:c,url:p+i,timeout:a.ajaxTimeout,dataType:"json",charset:"utf-8",headers:f||{},returnAll:!0},function(a,e){v(a,e)})})}};a["default"]=e});