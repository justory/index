"use strict";define(["exports","Msgini"],function(a,e){function t(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(a,"__esModule",{value:!0});var o=t(e),s={ajax:function(){for(var a=justory.configs,e=arguments.length,t=Array(e),s=0;e>s;s++)t[s]=arguments[s];var n="function"==typeof t.last()?t.last():"",r=this.type||"get",u=this.upload||!1,i=t[0],l=t[1]||{},d=l||{},f={},c=!1,g=a.baseUrl,p={},m={};a.ajaxComBeforeSend(d,function(e){var t=e.params,s=e.headers;if(t&&t.length>0)for(var j=0;j<t.length;j++){var y=t[j].key,h=t[j].value;d[y]=h,t[j].alwaysGet&&[m[y]=h]}if(s&&s.length>0)for(var j=0;j<s.length;j++){var y=s[j].key,h=s[j].value;f[y]=h}"post"==r&&(i=i.indexOf("?")>-1&&d&&"{}"!=JSON.stringify(d)?i+"&"+$.param(m):i+"?"+$.param(m),p={values:d},u&&[p.files=l]),("get"==r||"jsonp"==r)&&(i=i.indexOf("?")>-1&&d&&"{}"!=JSON.stringify(d)?i+"&"+$.param(d):i+"?"+$.param(d)),console.log(i),i.indexOf("http")>-1&&(g=""),console.log(456),justory.log("ajax send",{method:r,data:p,url:g+i});var v=function(e,t){justory.log("ajax result",{ret:e});var s=e.headers,r=e.body;if(r)a.ajaxComAfterSend(r,function(){n&&n(r,s)});else{var u="错误码："+t.code+"；错误信息："+t.msg+"；网络状态码："+t.statusCode,i=t.code;(""===i||void 0==i)&&(i="unknown"),justory.log("ajax message",{msg:u}),api.toast({msg:o["default"].ajax[i]}),"root"!=api.winName&&setTimeout(function(){api.closeWin()},3e3)}};"jsonp"==r?$.ajax({type:"GET",data:p,url:g+i,timeout:a.ajaxTimeout,dataType:"jsonp",headers:f||{},success:function(a){v({headers:{},body:a},{code:1})}}):api.ajax({method:r,tag:tag||"",cache:c,data:p,url:g+i,timeout:a.ajaxTimeout,dataType:"json",charset:"utf-8",headers:f||{},returnAll:!0},function(a,e){v(a,e)})})}};a["default"]=s});