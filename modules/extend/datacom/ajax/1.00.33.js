"use strict";define(["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var e={ajax:function(){for(var a=justory.configs,e=justory.msgcfgs,t=arguments.length,s=Array(t),o=0;t>o;o++)s[o]=arguments[o];var r="function"==typeof s.last()?s.last():"",n=this.type||"get",u=this.tag||"",d=this.upload||!1,i=s[0],f=s[1]||{},l=f||{},g={},j=!1,c=a.baseUrl,m={},p={};a.ajaxComBeforeSend(l,function(t){var s=t.params,o=t.headers;if(s&&s.length>0)for(var h=0;h<s.length;h++){var y=s[h].key,v=s[h].value;l[y]=v,s[h].alwaysGet&&[p[y]=v]}if(o&&o.length>0)for(var h=0;h<o.length;h++){var y=o[h].key,v=o[h].value;g[y]=v}"post"==n&&(i=i.indexOf("?")>-1?i+"&"+$.param(p):i+"?"+$.param(p),m={values:l},d&&[m.files=f]),("get"==n||"jsonp"==n)&&(i=i.indexOf("?")>-1?i+"&"+$.param(l):i+"?"+$.param(l)),i.indexOf("http")>-1&&(c=""),justory.log("ajax send",{method:n,data:m,url:c+i});var x=function(t,s){justory.log("ajax result",{ret:t});var o=t.headers,n=t.body;if(n)a.ajaxComAfterSend(n,function(){r&&r(n,o)});else{var u="错误码："+s.code+"；错误信息："+s.msg+"；网络状态码："+s.statusCode,d=s.code;(""===d||void 0==d)&&(d="unknown"),justory.log("ajax message",{msg:u}),api.toast({msg:e.ajax[d]})}};"jsonp"==n?$.ajax({type:"GET",data:m,url:c+i,timeout:a.ajaxTimeout,dataType:"jsonp",headers:g||{},success:function(a){x({headers:{},body:a},{code:1})}}):api.ajax({method:n,tag:u,cache:j,data:m,url:c+i,timeout:a.ajaxTimeout,dataType:"json",charset:"utf-8",headers:g||{},returnAll:!0},function(a,e){x(a,e)})})}};a["default"]=e});