"use strict";define(["exports"],function(a){Object.defineProperty(a,"__esModule",{value:!0});var e={ajax:function(){for(var a=justory.configs,e=justory.msgcfgs,t=arguments.length,o=Array(t),s=0;t>s;s++)o[s]=arguments[s];var r="function"==typeof o.last()?o.last():"",n=this.type||"get",u=this.tag||"",i=this.upload||!1,d=o[0],f=o[1]||{},l=f||{},c={},m=!1,p=a.baseUrl,g={},j={};a.ajaxComBeforeSend(l,function(t){var o=t.params,s=t.headers;if(o&&o.length>0)for(var h=0;h<o.length;h++){var y=o[h].key,v=o[h].value;l[y]=v,o[h].alwaysGet&&[j[y]=v]}if(s&&s.length>0)for(var h=0;h<s.length;h++){var y=s[h].key,v=s[h].value;c[y]=v}"post"==n&&(d=d.indexOf("?")>-1?d+"&"+$.param(j):d+"?"+$.param(j),g={values:l},i&&[g.files=f]),("get"==n||"jsonp"==n)&&(d=d.indexOf("?")>-1?d+"&"+$.param(l):d+"?"+$.param(l)),d.indexOf("http")>-1&&(p=""),justory.log("ajax send",{method:n,data:g,url:p+d});var x=function(t,o){justory.log("ajax result",{ret:t});var s=t.headers,n=t.body;if(n)a.ajaxComAfterSend(n,function(){r&&r(n,s)});else{var u="错误码："+o.code+"；错误信息："+o.msg+"；网络状态码："+o.statusCode,i=o.code;(""===i||void 0==i)&&(i="unknown"),justory.log("ajax message",{msg:u}),api.toast({msg:e.ajax[i]}),"root"!=api.winName&&setTimeout(function(){api.closeWin()},3e3)}};"jsonp"==n?$.ajax({type:"GET",data:g,url:p+d,timeout:a.ajaxTimeout,dataType:"jsonp",headers:c||{},success:function(a){x({headers:{},body:a},{code:1})}}):api.ajax({method:n,tag:u,cache:m,data:g,url:p+d,timeout:a.ajaxTimeout,dataType:"json",charset:"utf-8",headers:c||{},returnAll:!0},function(a,e){x(a,e)})})}};a["default"]=e});